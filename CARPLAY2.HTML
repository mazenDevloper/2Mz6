<!DOCTYPE html>
<!-- Set language to Arabic and direction to Right-to-Left for proper layout -->
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>واجهة CarPlay - تصميم زجاجي منسدل تفاعلي</title>
    <!-- Tailwind CSS for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons for modern SVG icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- 
        هام جداً:
        الكود سيعتمد الآن على ملف carplay.css الخارجي الذي تم تزويده للتحكم بالأنماط.
    -->
    <link rel="stylesheet" href="https://dmusera.netlify.app/carplay.css">
    
    <!-- 
        هام جداً:
        الكود سيعتمد الآن على ملف carplay.js الخارجي الذي تم تزويده.
        يجب أن يحتوي هذا الملف على مفتاح API الخاص بـ Google Maps ووظيفة initMap().
    -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?libraries=places&callback=initMap"></script>

</head>
<body class="animated-bg text-white overflow-hidden theme-gradient-1">
    <!-- SVG Filter Definition for Liquid Glass Effect -->
    <svg style="position: absolute; width: 0; height: 0; overflow: hidden;">
        <defs>
            <filter id="glass-filter" colorInterpolationFilters="sRGB" x="0%" y="0%" width="100%" height="100%">
                <!-- feImage source for displacement map - this is a generic pattern -->
                <feImage x="0" y="0" width="100%" height="100%" preserveAspectRatio="none" result="map" 
                    href="data:image/svg+xml,%3Csvg viewBox='0 0 400 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3ClinearGradient id='red-grad' x1='100%25' y1='0%25' x2='0%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%230000'/%3E%3Cstop offset='100%25' stop-color='red'/%3E%3C/linearGradient%3E%3ClinearGradient id='blue-grad' x1='0%25' y1='0%25' x2='0%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%230000'/%3E%3Cstop offset='100%25' stop-color='blue'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='0' y='0' width='400' height='200' fill='black'/%3E%3Crect x='0' y='0' width='400' height='200' rx='20' fill='url(%23red-grad)'/%3E%3Crect x='0' y='0' width='400' height='200' rx='20' fill='url(%23blue-grad)' style='mix-blend-mode: difference'/%3E%3Crect x='1.4' y='1.4' width='397.2' height='197.2' rx='20' fill='hsl(0 0% 50% / 0.93)' style='filter:blur(11px)'/%3E%3C/svg%3E"/>
                
                <!-- Displacement maps for RGB channels - adjusted scale for more distortion -->
                <feDisplacementMap in="SourceGraphic" in2="map" id="redchannel" scale="300" xChannelSelector="R" yChannelSelector="G" result="dispRed" />
                <feColorMatrix in="dispRed" type="matrix" values="1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0" result="red" />
                
                <feDisplacementMap in="SourceGraphic" in2="map" id="greenchannel" scale="310" xChannelSelector="R" yChannelSelector="G" result="dispGreen" />
                <feColorMatrix in="dispGreen" type="matrix" values="0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0" result="green" />
                
                <feDisplacementMap in="SourceGraphic" in2="map" id="bluechannel" scale="320" xChannelSelector="R" yChannelSelector="G" result="dispBlue" />
                <!-- Corrected feColorMatrix for blue channel to ensure real colors are reflected -->
                <feColorMatrix in="blue" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0" result="blue" />
                
                <!-- Blending channels -->
                <feBlend in="red" in2="green" mode="screen" result="rg" />
                <feBlend in="rg" in2="blue" mode="screen" result="output" />
                
                <!-- Gaussian blur for liquid effect - increased stdDeviation -->
                <feGaussianBlur in="output" stdDeviation="5" />
            </filter>
        </defs>
    </svg>

    <div class="w-full h-screen flex flex-col items-center justify-center p-4 sm:p-6">
        
        <!-- Top Bar: Wifi, 5G, Current Time -->
        <div class="w-full max-w-7xl flex justify-between items-center text-white/80 text-sm px-4 py-2 absolute top-4 left-1/2 -translate-x-1/2 z-10 top-bar">
            <div class="flex items-center gap-2">
                <i data-lucide="wifi"></i>
                <span>5G</span>
            </div>
            <div id="current-time">9:35</div>
        </div>

        <!-- Lexus Logo Fixed at Top Center (color changed to white using filter) -->
        <img src="https://dmusera.netlify.app/Lexus-Logo.wine.svg" width="200px" alt="Lexus Logo" class="fixed top-2 left-1/2 -translate-x-1/2 h-12 z-[1000] opacity-80" style="filter: invert(1) grayscale(100%) brightness(200%);" />

        <!-- Main CarPlay Interface Container -->
        <div id="carplay-main-interface" class="flex flex-row shadow-2xl rounded-3xl overflow-hidden bg-black/20 border border-white/10">
            
            <!-- Navigation Dock (Left Sidebar) -->
            <nav class="w-20 sm:w-24 bg-black/20 flex flex-col items-center justify-start pt-8 p-2 space-y-4 border-r border-white/10 flex-shrink-0 transition-opacity 0.3s ease;">
                <button data-app="Dashboard" class="app-icon">
                    <i data-lucide="layout-grid"></i>
                </button>
                <button data-app="Media" class="app-icon">
                    <i data-lucide="play-circle"></i>
                </button>
                 <button data-app="Radio" class="app-icon">
                    <i data-lucide="radio"></i>
                </button>
                <button data-app="AIAssistant" class="app-icon"> 
                    <i data-lucide="sparkles"></i> 
                </button>
                <button data-app="Weather" class="app-icon"> 
                    <i data-lucide="cloud-sun"></i> 
                </button>
                <button data-app="Map" class="app-icon"> <!-- New Map App Icon -->
                    <i data-lucide="map"></i> 
                </button>
                <button data-app="Quran" class="app-icon">
                    <i data-lucide="book-open"></i>
                </button>
                <!-- New Settings App Icon -->
                <button data-app="Settings" class="app-icon">
                    <i data-lucide="settings"></i>
                </button>
            </nav>

            <!-- Main content area for app screens -->
            <main class="flex-1 flex flex-col h-full">
                
                <!-- Dashboard Screen -->
                <section id="screen-Dashboard" class="app-screen p-4 md:p-6 flex-col h-full active">
                 
                    <!-- Dashboard Grid Layout -->
                    <!-- The main grid container for the dashboard content -->
                    <div class="dashboard-main-grid grid grid-cols-1 md:grid-cols-3 grid-rows-[80%_20%] gap-4 md:gap-6 h-full w-full">
                        
                        <!-- Column 1: Weather & Clock (occupies 1st column, 1st row) -->
                        <div class="flex flex-col gap-4 md:gap-6 col-span-1 row-start-1">
                            <!-- Weather Widget -->
                            <div class="glass-surface glass-surface--svg p-4 flex-grow flex flex-col items-center justify-center text-center">
                                <h2 class="text-xl font-bold mb-1">الطقس</h2>
                                <div id="weather-widget-container" class="w-full h-full flex flex-col items-center justify-center">
                                    <img id="dashboard-weather-icon" src="" alt="Weather Icon" class="w-16 h-16 text-white mb-2" />
                                    <p class="text-3xl font-extrabold mb-1" id="dashboard-weather-temp">--°C</p>
                                    <p class="text-lg text-white/70 mb-2" id="dashboard-weather-desc">--</p>
                                    <p class="text-sm text-white/50" id="dashboard-weather-location">صلالة، عمان</p>
                                </div>
                            </div>
                            <!-- Digital Clock Widget (Apple iOS 19 style) -->
                            <div class="glass-surface glass-surface--svg p-4 flex-grow flex flex-col items-center justify-center text-center">
                                <div id="digital-clock-widget" class="w-full h-full flex flex-col items-center justify-center text-center">
                                    <!-- Changed to spans for individual opacity control -->
                                    <div id="digital-time">
                                        <span class="hours">00</span>:<span class="minutes">00</span>:<span class="seconds">00</span>
                                    </div>
                                    <div id="digital-date">
                                        <div id="digital-date-line1">  </div>
                                        <div id="digital-date-line2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Column 2: 360 Camera View (occupies 2nd column, 1st row) -->
                        <div class="glass-surface glass-surface--svg p-2 flex flex-col items-center justify-center text-center car-cam-360-container col-span-1 row-start-1">
                            <img id="car-360-image" src="https://dmusera.netlify.app/es350gb.png" alt="عرض الكاميرا 360 درجة للسيارة" class="w-full h-full object-contain rounded-lg opacity-80">
                            <div class="car-cam-360-controls">
                                <input type="file" id="upload-360-image-input" accept="image/*" class="hidden" />
                                <button id="upload-360-image-button">
                                    <i data-lucide="upload" class="w-4 h-4"></i> تحميل صورة
                                </button>
                                <button id="reset-360-image-button">
                                    <i data-lucide="rotate-ccw" class="w-4 h-4"></i> إعادة تعيين
                                </button>
                            </div>
                        </div>

                        <!-- Column 3: Map (occupies 3rd column, 1st row) -->
                        <div class="rounded-3xl relative overflow-hidden flex items-center justify-center glass-surface glass-surface--svg p-1 col-span-1 row-start-1">
                            <!-- Google Map container -->
                            <div id="dashboard-google-map" class="full-iframe"></div>
                            <button id="get-my-location-button-dashboard" class="absolute bottom-4 left-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full transition-colors duration-200 flex items-center gap-2 text-sm">
                                <i data-lucide="map-pin" class="w-6 h-6"></i> تحديث الموقع
                            </button>
                        </div>

                        <!-- Prayer Times Widget (occupies all 3 columns, 2nd row) -->
                        <div class="glass-surface glass-surface--svg p-4 flex flex-col items-center justify-center text-center col-span-full row-start-2">
                           
                            <!-- Prayer times will be dynamically loaded here -->
                            <div id="prayer-times-container" class="prayer-times-row">
                                <div class="prayer-time-item">
                                    <span class="prayer-name">الفجر</span>
                                    <span class="prayer-time" id="fajr-time">--:--</span>
                                    <span class="prayer-iqama" id="fajr-iqama"></span>
                                </div>
                                
                                <div class="prayer-time-item">
                                    <span class="prayer-name">الظهر</span>
                                    <span class="prayer-time" id="dhuhr-time">--:--</span>
                                    <span class="prayer-iqama" id="dhuhr-iqama"></span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">العصر</span>
                                    <span class="prayer-time" id="asr-time">--:--</span>
                                    <span class="prayer-iqama" id="asr-iqama"></span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">المغرب</span>
                                    <span class="prayer-time" id="maghrib-time">--:--</span>
                                    <span class="prayer-iqama" id="maghrib-iqama"></span>
                                </div>
                                <div class="prayer-time-item">
                                    <span class="prayer-name">العشاء</span>
                                    <span class="prayer-time" id="isha-time">--:--</span>
                                    <span class="prayer-iqama" id="isha-iqama"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>

                <!-- Media (YouTube) Screen -->
                <section id="screen-Media" class="app-screen p-4 md:p-6 flex-col items-center justify-center h-full relative">
                    <h1 class="text-4xl font-bold mb-6 text-center">🎥 الوسائط المتعددة</h1>
                    
                    <!-- YouTube Search Input -->
                    <div class="w-full flex gap-2 mb-6">
                        <input
                            type="text"
                            id="youtube-search-input"
                            placeholder="ابحث في يوتيوب..."
                            class="flex-grow p-3 rounded-full bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-purple-500"
                            onkeypress="if(event.key === 'Enter') document.getElementById('youtube-search-button').click();"
                            readonly="true" <!-- Added readonly attribute -->
                        />
                        <button
                            id="youtube-search-button"
                            class="bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full transition-colors duration-200 flex items-center justify-center"
                        >
                            <i data-lucide="search"></i>
                        </button>
                    </div>

                    <!-- YouTube Search Suggestions -->
                    <div id="youtube-suggestions" class="w-full mb-4 hidden">
                        <!-- Suggestions will be dynamically loaded here -->
                    </div>

                    <!-- YouTube Playlist View -->
                    <div id="youtube-playlist-view" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 w-full h-full flex-grow overflow-y-auto">
                        <h2 class="col-span-full text-3xl font-bold mb-4 text-center">قوائم تشغيل يوتيوب</h2>
                        
                
                        
                        <!-- New YouTube Channels Added Below -->
                        <div class="glass-surface glass-surface--svg youtube-channel-card" data-playlist-id="UUlncV9OLPto_MinRzGfjr2g" data-channel-id="UClncV9OLPto_MinRzGfjr2g">
                            <img src="https://yt3.googleusercontent.com/ZpoYv5FstgResXDeuqEhkce079N0fM3UC5cmjGFBbKSPQI7tDXfl5W_vib_X2Q_hy5ipbZl4Fw=s160-c-k-c0x00ffffff-no-rj" alt="صورة الشيخ عبد الباسط عبد الصمد" />
                            <h2>تلاوات ياسر الدوسري</h2>
                        </div>
                        <div class="glass-surface glass-surface--svg youtube-channel-card" data-playlist-id="UUFPqvE8BYiiUeN1AUXa3lbA" data-channel-id="UCFPqvE8BYiiUeN1AUXa3lbA">
                            <img src="https://imgs.search.brave.com/-WtPBvI7AmvUdQ2X1oZpk6wlNV-PlUSktoA9JVVQL3o/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9zdGF0/aWMuc3VyYXRtcDMu/Y29tL3BpY3MvcmVj/aXRlcnMvdGh1bWJz/LzM3XzE2MF8xNjAu/anBn" alt="صورة الشيخ مشاري العفاسي" />
                            <h2>الشيخ محمد ايوب </h2>
                        </div>
                        <div class="glass-surface glass-surface--svg youtube-channel-card" data-playlist-id="UUy0WYogELm9hEjulWPeYOJg" data-channel-id="UCy0WYogELm9hEjulWPeYOJg">
                            <img src="https://yt3.googleusercontent.com/jE4NSU3a46l5ZI5rTvaq2Jvk_TWWS3GtPhs4qchBQagGTeypLWC1V3ewrcE1xbMOgkZaHGGNWA=s160-c-k-c0x00ffffff-no-rj" alt="صورة الشيخ ماهر المعيقلي" />
                            <h2>مزامير القرآن</h2>
                        </div>
                        <!-- End of New YouTube Channels -->
                    </div>

                    <!-- YouTube Video List View -->
                    <div id="youtube-video-list-view" class="hidden flex-col items-center justify-center h-full w-full relative p-4 overflow-y-auto gap-4 flex-grow">
                        <button id="back-to-playlists-from-videos" class="absolute top-4 left-4 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-full transition-colors duration-200 flex items-center gap-2 text-sm">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i> العودة لقوائم التشغيل
                        </button>
                        <h2 class="text-3xl font-bold mb-4 text-center w-full">فيديوهات قائمة التشغيل</h2>
                        <div id="video-list-container" class="flex flex-col gap-4 w-full">
                            <!-- Videos will be dynamically loaded here -->
                        </div>
                        <!-- Bottom "Back to Playlists" Button -->
                        <button id="back-to-playlists-bottom-button" class="mt-4 bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-full transition-colors duration-200 flex items-center justify-center gap-2 text-base">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i> العودة إلى قوائم التشغيل الرئيسية
                        </button>
                    </div>

                    <!-- YouTube Search Results View -->
                    <div id="youtube-search-results-view" class="hidden flex-col items-center justify-center h-full w-full relative p-4 overflow-y-auto gap-4 flex-grow">
                        <h2 class="text-3xl font-bold mb-4 text-center w-full">نتائج البحث</h2>
                        <div id="search-results-container" class="flex flex-col gap-4 w-full">
                            <!-- Search results will be dynamically loaded here -->
                        </div>
                        <!-- Bottom "Back to Playlists" Button for search results -->
                        <button id="back-to-playlists-bottom-button-search" class="mt-4 bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-full transition-colors duration-200 flex items-center justify-center gap-2 text-base">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i> العودة إلى قوائم التشغيل الرئيسية
                        </button>
                    </div>

                    <!-- YouTube Video Player View (This section will now be unused for initial playback from lists/search) -->
                    <div id="youtube-player-view" class="hidden flex-col items-center justify-center h-full w-full relative flex-grow">
                        <iframe
                            id="youtube-player-iframe"
                            class="full-iframe"
                            src="" 
                            title="YouTube video player"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen
                        ></iframe>
                        <!-- Minimize Video Button (now "Back to List") -->
                        <button id="minimize-video-button" class="absolute bottom-4 left-1/2 -translate-x-1/2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full transition-colors duration-200 flex items-center gap-2 text-sm">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i> العودة إلى الخلف
                        </button>
                    </div>
                </section>
                
                <!-- Radio Screen -->
                <section id="screen-Radio" class="app-screen items-center justify-center h-full w-full p-4 md:p-6">
                   <iframe class="full-iframe" title="Radio Garden" src="https://radio.garden/visit/salalah/A13sFegC"></iframe>
                </section>

                <!-- AI Assistant Screen -->
                <section id="screen-AIAssistant" class="app-screen p-4 md:p-6 flex-col justify-between h-full">
                    <h1 class="text-4xl font-bold mb-4 text-center">مساعد Gemini الذكي ✨</h1>
                    <div id="chat-history" class="flex-grow overflow-y-auto p-4 rounded-xl glass-surface glass-surface--svg mb-4">
                        <div class="chat-message ai">أهلاً بك! كيف يمكنني مساعدتك اليوم؟ يمكنك سؤالي عن سرعة السيارة، مستوى الوقود، RPM، درجة الحرارة، أو الترس.</div>
                        <div id="listening-indicator" class="chat-message ai hidden">جاري الاستماع...</div>
                    </div>
                    <div class="flex gap-2">
                        <input
                            type="text"
                            id="ai-input"
                            placeholder="اسألني أي شيء..."
                            class="flex-grow p-3 rounded-full bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-purple-500"
                            onkeypress="if(event.key === 'Enter') document.getElementById('ai-send-button').click();"
                        />
                        <button
                            id="ai-mic-button" 
                            class="bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full transition-colors duration-200 flex items-center justify-center"
                        >
                            <i data-lucide="mic"></i>
                        </button>
                        <button
                            id="ai-send-button"
                            class="bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full transition-colors duration-200 flex items-center justify-center"
                        >
                            <i data-lucide="send"></i>
                        </button>
                    </div>
                </section>

                <!-- Weather Screen -->
                <section id="screen-Weather" class="app-screen p-4 md:p-6 flex-col items-center justify-center h-full">
                    <h1 class="text-4xl font-bold mb-6">الطقس <i data-lucide="cloud-sun"></i></h1>
                    <div class="w-full h-full flex flex-col gap-4">
                        <!-- Main Weather Card (Top) -->
                        <div class="glass-surface glass-surface--svg p-6 rounded-3xl text-center flex flex-col items-center justify-center flex-grow">
                            <div class="text-3xl font-bold mb-2" id="weather-location">صلالة، عمان</div>
                            <img id="weather-icon" src="" alt="Weather Icon" class="w-24 h-24 text-yellow-400 mb-4" />
                            <p class="text-6xl font-extrabold mb-2" id="weather-temp">--°C</p>
                            <p class="text-xl text-white/70 mb-4" id="weather-desc">--</p>
                            <p class="text-sm text-white/50" id="weather-feels-like">الشعور كـ: --°C</p>
                            <p class="text-sm text-white/50" id="weather-last-updated">آخر تحديث: --</p>
                        </div>

                        <!-- Additional Details (Bottom Grid) -->
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 w-full">
                            <div class="glass-surface glass-surface--svg p-4 rounded-3xl text-center flex flex-col items-center justify-center">
                                <i data-lucide="droplet" class="w-10 h-10 text-blue-300 mb-2"></i>
                                <span class="text-2xl font-bold" id="weather-humidity">--%</span>
                                <span class="text-sm text-white/50">الرطوبة</span>
                            </div>
                            <div class="glass-surface glass-surface--svg p-4 rounded-3xl text-center flex flex-col items-center justify-center">
                                <i data-lucide="wind" class="w-10 h-10 text-gray-300 mb-2"></i>
                                <span class="text-2xl font-bold" id="weather-wind">-- كم/س</span>
                                <span class="text-sm text-white/50">الرياح</span>
                            </div>
                            <div class="glass-surface glass-surface--svg p-4 rounded-3xl text-center flex flex-col items-center justify-center">
                                <i data-lucide="gauge" class="w-10 h-10 text-green-300 mb-2"></i>
                                <span class="text-2xl font-bold" id="weather-pressure">-- mb</span>
                                <span class="text-sm text-white/50">الضغط</span>
                            </div>
                            <div class="glass-surface glass-surface--svg p-4 rounded-3xl text-center flex flex-col items-center justify-center">
                                <i data-lucide="eye" class="w-10 h-10 text-purple-300 mb-2"></i>
                                <span class="text-2xl font-bold" id="weather-visibility">-- كم</span>
                                <span class="text-sm text-white/50">الرؤية</span>
                            </div>
                            <div class="glass-surface glass-surface--svg p-4 rounded-3xl text-center flex flex-col items-center justify-center">
                                <i data-lucide="sun" class="w-10 h-10 text-orange-300 mb-2"></i>
                                <span class="text-2xl font-bold" id="weather-uv">--</span>
                                <span class="text-sm text-white/50">مؤشر الأشعة فوق البنفسجية</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- NEW Map Screen -->
                <section id="screen-Map" class="app-screen p-4 md:p-6 flex-col h-full">
                    <h1 class="text-4xl font-bold mb-6 text-center">الخريطة والاتجاهات 🗺️</h1>
                    <div class="flex flex-col md:flex-row h-full w-full gap-4">
                        <!-- Left Panel: Search and Controls (25%) -->
                        <div class="w-full md:w-1/4 flex flex-col gap-4 glass-surface glass-surface--svg p-4 rounded-3xl flex-shrink-0">
                            <h2 class="text-xl font-bold text-center mb-2">تحديد الوجهة والبحث</h2>
                            <div class="flex flex-col gap-2">
                                <label for="destination-input" class="text-sm text-white/70">الوجهة:</label>
                                <input
                                    type="text"
                                    id="destination-input"
                                    placeholder="أدخل الوجهة أو رابط Google Maps..."
                                    class="p-2 rounded-lg bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                                <button
                                    id="start-directions-button"
                                    class="bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 font-bold"
                                >
                                    <i data-lucide="navigation" class="w-5 h-5"></i> البحث عن الاتجاهات
                                </button>
                                <button
                                    id="toggle-traffic-button"
                                    class="bg-gray-700 hover:bg-gray-600 text-white p-3 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 font-bold mt-2"
                                >
                                    <i data-lucide="traffic-cone" class="w-5 h-5"></i> إظهار حركة المرور
                                </button>
                            </div>
                            <div class="flex flex-col gap-2 mt-4 text-center">
                                <div class="flex items-center justify-center gap-2">
                                    <i data-lucide="clock" class="w-6 h-6 text-green-400"></i>
                                    <span class="text-lg font-semibold">الوقت المقدر:</span>
                                    <span id="eta-display" class="text-lg">--</span>
                                </div>
                                <div class="flex items-center justify-center gap-2">
                                    <i data-lucide="ruler" class="w-6 h-6 text-purple-400"></i>
                                    <span class="text-lg font-semibold">المسافة:</span>
                                    <span id="distance-display" class="text-lg">--</span>
                                </div>
                            </div>
                        </div>
                        <!-- Right Panel: Google Map (75%) -->
                        <div class="w-full md:w-3/4 rounded-3xl relative overflow-hidden flex items-center justify-center glass-surface glass-surface--svg p-1">
                            <div id="full-google-map" class="full-iframe"></div>
                            <button id="get-my-location-button-full-map" class="absolute bottom-4 left-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full transition-colors duration-200 flex items-center gap-2 text-sm">
                                <i data-lucide="map-pin" class="w-4 h-4"></i> تحديث الموقع
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- Settings Screen -->
                <section id="screen-Settings" class="app-screen p-4 md:p-6 flex-col h-full">
                    <h1 class="text-4xl font-bold mb-6 text-center">الإعدادات</h1>
                    
                    <!-- Media Settings Card -->
                    <div class="glass-surface glass-surface--svg p-4 rounded-3xl mb-6 flex flex-col">
                        <h2 class="text-2xl font-semibold mb-4">إعدادات الوسائط</h2>
                        
                        <!-- Add YouTube Channel -->
                        <div class="mb-4">
                            <label for="new-channel-url" class="block text-sm font-medium text-white/70">إضافة قناة يوتيوب:</label>
                            <div class="mt-1 flex gap-2 items-center">
                                <input type="text" id="new-channel-url" placeholder="رابط القناة أو معرفها" class="flex-grow p-2 rounded-lg bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <input type="file" id="new-channel-image" accept="image/*" class="hidden">
                                <button id="upload-channel-image-button" class="bg-gray-700 hover:bg-gray-600 text-white p-2 rounded-lg transition-colors duration-200" title="رفع صورة للقناة">
                                    <i data-lucide="image" class="w-5 h-5"></i>
                                </button>
                                <button id="add-channel-button" class="bg-purple-600 hover:bg-purple-700 text-white p-2 rounded-lg transition-colors duration-200" title="إضافة قناة">
                                    <i data-lucide="plus" class="w-5 h-5"></i>
                                </button>
                            </div>
                            <img id="new-channel-image-preview" src="" alt="صورة المعاينة" class="mt-2 rounded-lg max-h-20 hidden">
                        </div>
                        
                        <!-- Add Search Keywords -->
                        <div>
                            <label for="new-search-keywords" class="block text-sm font-medium text-white/70">إضافة كلمات مفتاحية للبحث:</label>
                            <div class="mt-1 flex gap-2 items-center">
                                <input type="text" id="new-search-keywords" placeholder="أضف كلمات مفتاحية (مثل: سورة، قارئ)" class="flex-grow p-2 rounded-lg bg-white/10 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-purple-500">
                                <button id="add-keywords-button" class="bg-purple-600 hover:bg-purple-700 text-white p-2 rounded-lg transition-colors duration-200" title="إضافة كلمة مفتاحية">
                                    <i data-lucide="plus" class="w-5 h-5"></i>
                                </button>
                            </div>
                            <div id="keyword-list" class="mt-2 flex flex-wrap gap-2 text-sm text-white/80">
                                <!-- Keywords will be displayed here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Map Settings Card -->
                    <div class="glass-surface glass-surface--svg p-4 rounded-3xl flex-grow">
                        <h2 class="text-2xl font-semibold mb-4">إعدادات الخرائط</h2>
                        
                        <!-- Restrict Search Toggle -->
                        <div class="flex items-center justify-between">
                            <span class="text-lg">قصر البحث على محافظة ظفار</span>
                            <label class="switch">
                                <input type="checkbox" id="restrict-map-toggle">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- Electronic Quran App Screen -->
                <section id="screen-Quran" class="app-screen p-4 md:p-6 flex-col items-center justify-center h-full relative">
                   <div id="quran-quick-access" class="mt-4 bg-black/30 p-4 rounded-xl flex flex-col gap-3 items-end z-20 glass-surface glass-surface--svg w-full max-w-md">
                        
                        <button id="quran-go-button" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full transition-colors duration-200 flex items-center gap-2 text-sm self-center">
                            
                        </button>
                    </div>
                   
                    <div class="w-full h-full glass-surface glass-surface--svg p-4 rounded-xl flex flex-col items-center flex-grow" style="
    height: 100%!important;
">
                        <iframe
                            id="quran-iframe"
                            class="full-iframe"
                            src="https://quran.com/?lang=ar"
                            lang="ar"
                            title="القرآن الكريم"
                            frameborder="0"
                            allowfullscreen
                        ></iframe>
                    </div>
                    <!-- Quran Quick Access Section -->
                    
                </section>

            </main>
        </div>
    </div>

    <!-- Floating Full-Screen Button -->
    <button id="floating-fullscreen-button" class="glass-surface glass-surface--svg rounded-full">
        <i data-lucide="maximize" class="w-6 h-6"></i>
        
    </button>

    <!-- Floating Media Button -->
    <button id="floating-media-button" class="glass-surface glass-surface--svg rounded-full">
        <i data-lucide="youtube" class="w-6 h-6"></i>
    </button>

    <!-- Floating Keyboard Button (New) -->
    <button id="floating-keyboard-button" class="glass-surface glass-surface--svg rounded-full">
        <i data-lucide="keyboard" class="w-6 h-6"></i>
    </button>

    <!-- Clear Search Button (New) -->
    <button id="clear-search-button" class="glass-surface glass-surface--svg rounded-full">
        <i data-lucide="x" class="w-4 h-4"></i>
    </button>

    <!-- Floating Start Trip Button (New) -->
    <button id="start-trip-floating-button" class="glass-surface glass-surface--svg rounded-full">
        <i data-lucide="map-pin" class="w-6 h-6"></i> بدء الرحلة
    </button>

    <!-- Video Pop-up Container -->
    <div id="video-popup-container">
        <iframe
            id="video-popup-iframe"
            src=""
            title="YouTube video player pop-up"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
        ></iframe>
        <div class="video-popup-controls">
            <button id="video-popup-close-button" title="إغلاق الفيديو">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        </div>
    </div>
    
    <!-- 
        تمت إزالة كود JavaScript من هنا
        وسيتم الآن استخدام الملف الخارجي لتوفير المنطق
    -->
    <script src="https://dmusera.netlify.app/carplay.js"></script>
</body>
</html>
